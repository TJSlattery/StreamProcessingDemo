[
    {
      $match: {
        "value.Id": "131D7000000oiSJIAY" // Optional: Match the specific document if needed
      }
    },
    {
      $lookup: {
        from: {
          "connectionName": "demo_destination",
          "db": "users",
          "coll": "info"
        }
        localField: "value.CreatedById",
        foreignField: "Id",
        as: "createdByInfo"
      }
    },
    {
      $lookup: {
        from: "Accounts",
        localField: "value.Account__c",
        foreignField: "AccountId", 
        as: "accountInfo"
      }
    },
    {
      $project: {
        _id: "$value.Id",
        createdBy: "$createdByInfo.Name", // Accessing the first element directly
        createdDate: "$value.CreatedDate",
        lastModifiedBy: "$value.LastModifiedById", // You might need another $lookup for LastModifiedBy
        lastModifiedDate: "$value.LastModifiedDate",
        id: "$value.Id",
        customerAccountId: "$accountInfo.AccountNumber", // Accessing the first element directly
        locationType: "$value.LocationType",
        isFreightForwarder: "$value.IsMobile", // Mapping based on your logic
        isDefault: "$value.Is_Default__c",
        name: "$value.Name",
        phone: "$value.Phone__c",
        address: {
          city: "$value.Address__City__s",
          country: "$value.Address__CountryCode__s",
          latitude: "$value.Address__Latitude__s",
          longitude: "$value.Address__Longitude__s",
          postalCode: "$value.Address__PostalCode__s",
          state: "$value.Address__StateCode__s",
          street: "$value.Address__Street__s"
        }
      }
    },
    {
      $addFields: {
        createdDate: {
          $toDate: "$createdDate"
        },
        lastModifiedDate: {
          $toDate: "$lastModifiedDate"
        }
      }
    },
    {
      $project: {
        "createdByInfo": 0, // Remove the temporary createdByInfo field
        "accountInfo": 0,   // Remove the temporary accountInfo field
        "value": 0,         // Remove the original 'value' field
        "timestamp": 0,
        "timestampType": 0,
        "partition": 0,
        "offset": 0,
        "key": 0,
        "headers": 0
      }
    }
  ]